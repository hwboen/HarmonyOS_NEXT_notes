ArkTS 是 HarmonyOS 的主力语言，它在 TS 基础上拓展，并在以下几个方面做了改进和优化：

- 强制使用静态类型
  编译时通过确定的静态类型，检查代码的正确性，减少运行时的类型检查，提升性能。

- 禁止在运行时修改对象布局
  ArkTS 为了实现最大性能，禁止在运行时修改对象布局。

  - 什么是对象布局？
    对象布局指的是对象在内存中的布局。我们用一个具体的例子，来具象化对象在内存中的布局：

    ```
    class Account {
      int id // 假设2字节
      double balance // 假设4字节
      Bank bank // 对象引用
    }
    class Bank {
      string name
    }
    ```

    现在假设我们有一个类型为 Account 的对象，它在内存中的布局大致是这样的：

    - 对象头 Object Header
      首先是对象头，它存储对象的元数据，例如哈希值，GC 信息，锁信息等，字节长度固定，假设占用 2 字节
    - 属性 id
      id 为 int 类型，在内存中占用 2 字节
    - 属性 balance
      balance 为 double 类型，在内存中占用 4 字节
    - 引用类型 bank
      bank 为引用类型，在内存中假设占用 4 字节

    最终该对象在内存占用了一块连续的内存如下：
    `|对象头2字节|id2字节|balance4字节|bank4字节|`

  - 修改对象布局对性能会造成什么影响？

    要理解这个问题，我们拿最典型的内存对齐的例子来做说明。

    - 什么是内存对齐？

      现在硬件为了提升内存读取的效率，规定每次内存 IO 的单位是固定的。内存对齐通过优化对象布局，使得数据的起始地址位于对齐边界，减少内存读取的次数，提升效率。

    因此在运行时修改对象布局，会使得内存对齐这类的优化失效，降低性能。

- 不支持 Structural typing

  TS 支持 Structural typing，只要包含特定的属性或方法，它们就相互兼容或者可以简单确定为同一类型。

  ArkTS 不支持该特性，实现这个特性成本很大，而且破坏了静态类型带来的好处。
